# Nutrient Node.js Document Converter

## ğŸ¯ Overview

A comprehensive Node.js solution for converting Office documents (DOCX, PPTX, XLSX) to PDF using the Nutrient SDK, with batch processing capabilities and Windows compatibility solutions.

## ğŸš¨ Windows Path Issue & Solution

### The Problem

On Windows, the Node.js ES module loader expects `file://` URLs for paths, but drive-letter paths like `D:\path\to\file` are not handled, causing:

```
Error [ERR_UNSUPPORTED_ESM_URL_SCHEME]: Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'd:'
```

### The Solution

Use WSL (Windows Subsystem for Linux) or a native Linux/macOS environment:

```bash
# Open WSL terminal
wsl

# Navigate to your project
cd /mnt/d/your-project-path

# Run conversions normally
node converter.mjs
```

## ğŸ”§ Prerequisites

- **Node.js 18+** (in WSL/Linux environment)
- **WSL2** (for Windows users) or **native Linux/macOS**
- **Nutrient SDK license** (optional, includes watermark without license)

### Installing WSL (Windows Users)

```powershell
# Install WSL
wsl --install

# Or install a specific distribution
wsl --install -d Ubuntu-22.04

# Update WSL
wsl --update
```

### Installing Node.js in WSL

```bash
# Update system
sudo apt update

# Install Node.js
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# Verify installation
node --version
npm --version
```

## ğŸš€ Installation

```bash
# Clone the repository
git clone https://github.com/Narashiman-K/NutrientNodejsCoverterSample.git
cd NutrientNodejsCoverterSample

# Install dependencies
npm install
```

## ğŸ“ Project Structure

```text
nutrient-nodejs-converter/
â”œâ”€â”€ README.md
â”œâ”€â”€ package.json
â”œâ”€â”€ .gitignore
â”œâ”€â”€ converter.mjs            # Single-file conversion script
â”œâ”€â”€ batch-converter.mjs      # Batch processing with advanced features
â”œâ”€â”€ run-batch.mjs            # Simple batch runner
â”œâ”€â”€ advanced-batch.mjs       # Advanced batch processing options
â”œâ”€â”€ converted-pdfs/          # Output directory (auto-created)
â”œâ”€â”€ batch-converted/         # Batch output directory (auto-created)
â””â”€â”€ conversion-log.txt       # Detailed conversion logs
```

## ğŸ”„ Usage

### Single File Conversion

```javascript
// converter.mjs
import { load } from '@nutrient-sdk/node';
import fs from 'fs';

const docxBuffer = fs.readFileSync('document.docx');
const instance = await load({ document: docxBuffer });
const pdfBuffer = await instance.exportPDF();
fs.writeFileSync('output.pdf', Buffer.from(pdfBuffer));
await instance.close();
```

Run the script:

```bash
node converter.mjs
```

### Batch Processing

```bash
# Simple batch conversion
npm run batch

# Advanced batch with options
npm run batch-advanced

# Custom batch run
node run-batch.mjs
```

## Batch Processing Features

- âœ… **Concurrent Processing** (configurable)
- âœ… **Progress Tracking** with real-time updates
- âœ… **Error Handling** - Continues on individual failures
- âœ… **Detailed Logging** with timestamps
- âœ… **Smart Skip** - Avoids re-converting existing files
- âœ… **Comprehensive Reports** - Success rates, file sizes, timing
- âœ… **Memory Management** - Proper cleanup to prevent leaks

## âš™ï¸ Configuration Options

```javascript
const options = {
  inputFolder: '/mnt/d/your-documents',     // Source folder
  outputFolder: './converted-pdfs',         // Output folder
  maxConcurrent: 3,                         // Concurrent processing limit
  supportedExtensions: ['.docx', '.doc', '.pptx', '.ppt', '.xlsx', '.xls']
};
```

## ğŸ“Š Sample Output

```text
ğŸš€ Starting batch conversion process...
ğŸ“ Found 15 office documents in /mnt/d/documents
ğŸ”„ 12 files need conversion (3 already converted)

ğŸ“‹ Files to convert:
1. annual-report.docx
2. presentation.pptx
3. budget-2024.xlsx
...

ğŸ”„ Starting conversion of 12 files...
âš™ï¸  Processing 3 files concurrently

ğŸ“¦ Processing batch 1/4 (3 files)
âœ… SUCCESS: annual-report.docx (245.67KB -> 198.34KB) in 3.45s
âœ… SUCCESS: presentation.pptx (1406.46KB -> 892.15KB) in 5.23s
âœ… SUCCESS: budget-2024.xlsx (13.64KB -> 25.89KB) in 2.11s

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     BATCH CONVERSION REPORT                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Total Files Processed:  12                                     â•‘
â•‘ Successful:             11                                     â•‘
â•‘ Failed:                  1                                     â•‘
â•‘ Success Rate:          91.7%                                   â•‘
â•‘                                                                â•‘
â•‘ Total Input Size:    2847.23 KB                               â•‘
â•‘ Total Output Size:   2156.78 KB                               â•‘
â•‘ Compression Ratio:    24.3%                                   â•‘
â•‘ Total Duration:        45.67 seconds                          â•‘
â•‘ Average per File:       3.81 seconds                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## ğŸ› ï¸ Troubleshooting

### Issue: Cannot find module '@nutrient-sdk/node'

```bash
npm install @nutrient-sdk/node
```

### Issue: Windows path errors

Use WSL:

```bash
wsl
cd /mnt/d/your-project
node converter.mjs
```

### Issue: Permission denied

```bash
sudo chown -R $USER:$USER /mnt/d/your-project
```

### Issue: Large files timeout

Increase processing time or reduce concurrency:

```javascript
const options = {
  maxConcurrent: 1,  // Process one at a time
  timeout: 300000    // 5 minutes timeout
};
```

## ğŸ“ Package.json Scripts

```json
{
  "scripts": {
    "convert": "node converter.mjs",
    "batch": "node batch-converter.mjs",
    "batch-run": "node run-batch.mjs",
    "batch-advanced": "node advanced-batch.mjs"
  }
}
```

## ğŸ› Issues & Workarounds

### Windows Compatibility

**Issue:** ES module path resolution fails on Windows  
**Workaround:** Use WSL or a Linux environment

### File Permissions

**Issue:** WSL file permission problems  
**Workaround:** Use `sudo chown` or adjust WSL mount options

## ğŸ¤ Contributing

1. Fork the repository  
2. Create a feature branch: `git checkout -b feature/amazing-feature`  
3. Commit your changes: `git commit -m "Add amazing feature"`  
4. Push to the branch: `git push origin feature/amazing-feature`  
5. Open a Pull Request

## ğŸ™ Acknowledgments

- Nutrient for the powerful document processing SDK  
- The Node.js community for excellent tooling  
- WSL team for making Windows-Linux interoperability seamless

## ğŸ“§ Support

For issues related to:  
- **Nutrient SDK:** https://support.nutrient.io/hc/en-us/requests/new  
- **WSL:** Check Microsoft WSL Documentation

## Author

[Narashiman](https://www.linkedin.com/in/narashimank/)
